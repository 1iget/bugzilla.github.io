[%# 3.0.4, 3.1.4, and 2.22.4 Security Advisory %]
[% title = "3.0.4, 3.1.4, and 2.22.4 Security Advisory" %]

<h1>3.0.4, 3.1.4, and 2.22.4 Security Advisory</h1>
August 12, 2008<br/>
<pre>
Summary
=======

Bugzilla is a Web-based bug-tracking system, used by a large number of
software projects.

This advisory covers a security issue that has recently been fixed
in the Bugzilla code:

* Local files on the server can be attached to a bug (making them
  publicly visible) when importing bugs with --attach_path

All affected installations are encouraged to upgrade as soon as possible.

Vulnerability Details
=====================

Class:       Directory Traversal
Versions:    2.22.1 - 2.22.4, 2.23.3 and higher
Description: When importing bugs using importxml.pl, the --attach_path
             option can be specified, pointing to the directory where
             attachments to import are stored. If the XML file being
             read by importxml.pl contains a malicious
             &lt;data encoding="filename"&gt;../relative_path/to/local_file&lt;/data&gt;
             node, the script follows this relative path and attaches the
             local file pointed by it to the bug, making the file public.
             The security fix makes sure the relative path is always
             ignored.
             Most Bugzilla installations will not be vulnerable, as
             they do not use --attach_path with importxml.pl.
             (In fact, most installations don't use importxml.pl at all.)
Reference:   https://bugzilla.mozilla.org/show_bug.cgi?id=437169


Vulnerability Solutions
=======================

The fix for the security bug mentioned in this advisory is included in
the 3.2rc1, 3.0.5, and 2.22.5 releases. Upgrading to these releases
will protect installations from possible exploits of this issue.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and CVS upgrade instructions are available at:

  https://www.bugzilla.org/download/


Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix
these issues:

Greg Hendricks
Frédéric Buclin
Ilja van Sprundel

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing these
forums.
</pre>
